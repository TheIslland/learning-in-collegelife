# 操作系统学习

## １．进程

**关于开启子进程的fork简介：**

          fork英文原意是“分岔，分支”的意思，而在操作系统中，乃是著名的Unix（或类Unix，如Linux，Minix）中用于创建子进程的系统调用。 

  【NOTE1】  fork () 的作用是什么？换句话说，你用 fork () 的目的是什么？

――是为了产生一个新的进程。＝＝》产生一个什么样的进程？

――和你本来调用 fork () 的那个进程基本一样的进程，其实就是你原来进程的副本; ＝＝》 真的完全一样吗？  		――当然不能完全一样，你要两个除了 pid 之外其它一模一样的进程干什么。＝＝》 哪里不一样？  

――当然最重要的是 fork () 之后执行的代码不一样。＝＝》  怎么实现呢？  

――如果是unix 会让两个进程（不错，原来是一个，unix 替你复制了一个，现在有两个），在 fork () 之后产生不同：返回值不同。其中一个进程（使用新的 pid）里面的 fork () 返回零，  这个进程就是“子进程”；而另一个进程（使用原来的 pid）中的 fork () 返回前面那个子进程的  pid，他自己被称为“父进程”  ＝＝》然后呢？  

――根据返回值是否非零来判断了，现在我是在子进程里面呢，还是在  父进程里面？在子进程里面就执行子进程该执行的代码，在父进程里面就执行父进程的代码……      ＝＝》是把所有的代码复制到子进程中吗？二者代码完全一样吗？

――子进程包含父进程、子进程的代码，父进程包含父进程子进程的代码，岂不是多占用内存了吗？  ――unix 代码段都是可重入代码，也就是说，进程复制，并不复制代码段，若干个进程  共享同一代码段，增加的只是全局共享数据和对文件描述符的引用等，另外就是堆栈。你一个代码  长达 10M 的进程，fork () 出三四个子进程，只是增加一点内存占用（如果你没有使用很多全局变量  的话），而不是占用 40M 以上的内存。  

